/**
 * skylark-flipster - A version of flipster.js that ported to running on skylarkjs.
 * @author Hudaokeji, Inc.
 * @version v0.9.0
 * @link https://github.com/skylark-integration/skylark-flipster/
 * @license MIT
 */
define(["skylark-jquery"],function(t){"use strict";function e(t,e){var n=null;return function(){var i=this,r=arguments;null===n&&(n=setTimeout(function(){t.apply(i,r),n=null},e))}}var n,i=(n={},function(t){if(void 0!==n[t])return n[t];var e=document.createElement("div").style,i=t.charAt(0).toUpperCase()+t.slice(1),r=(t+" "+["webkit","moz","ms","o"].join(i+" ")+i).split(" ");for(var a in r)if(r[a]in e)return n[t]=r[a];return n[t]=!1}),r="http://www.w3.org/2000/svg",a=function(){var t;return function(){if(void 0!==t)return t;var e=document.createElement("div");return e.innerHTML="<svg/>",t=e.firstChild&&e.firstChild.namespaceURI===r}}(),o=t(window),s=i("transform"),l={itemContainer:"ul",itemSelector:"li",start:"center",fadeIn:400,loop:!1,autoplay:!1,pauseOnHover:!0,style:"coverflow",spacing:-.6,click:!0,keyboard:!0,scrollwheel:!0,touch:!0,nav:!1,buttons:!1,buttonPrev:"Previous",buttonNext:"Next",onItemSwitch:!1},c={main:"flipster",active:"flipster--active",container:"flipster__container",nav:"flipster__nav",navChild:"flipster__nav__child",navItem:"flipster__nav__item",navLink:"flipster__nav__link",navCurrent:"flipster__nav__item--current",navCategory:"flipster__nav__item--category",navCategoryLink:"flipster__nav__link--category",button:"flipster__button",buttonPrev:"flipster__button--prev",buttonNext:"flipster__button--next",item:"flipster__item",itemCurrent:"flipster__item--current",itemPast:"flipster__item--past",itemFuture:"flipster__item--future",itemContent:"flipster__item__content"},u=new RegExp("\\b("+c.itemCurrent+"|"+c.itemPast+"|"+c.itemFuture+")(.*?)(\\s|$)","g"),f=new RegExp("\\s\\s+","g");return t.fn.flipster=function(n){if("string"==typeof n){var i=Array.prototype.slice.call(arguments,1);return this.each(function(){var e=t(this).data("methods");return e[n]?e[n].apply(this,i):this})}var p=t.extend({},l,n);return this.each(function(){var n,i,l,v,h,d,m,g,_,y=t(this),b=[],x=0,w=!1,C=!1;function k(e){return e=e||"next",t('<button class="'+c.button+" "+("next"===e?c.buttonNext:c.buttonPrev)+'" role="button" />').html(function(t){var e="next"===t?p.buttonNext:p.buttonPrev;return"custom"!==p.buttons&&a?'<svg viewBox="0 0 13 20" xmlns="'+r+'" aria-labelledby="title"><title>'+e+'</title><polyline points="10,3 3,10 10,17"'+("next"===t?' transform="rotate(180 6.5,10)"':"")+"/></svg>":e}(e)).on("click",function(t){D(e),t.preventDefault()})}function I(){y.css("transition",""),i.css("transition",""),h.css("transition","")}function P(e){var n,r;e&&(y.css("transition","none"),i.css("transition","none"),h.css("transition","none")),l=i.width(),i.height((r=0,h.each(function(){(n=t(this).height())>r&&(r=n)}),r)),l?(v&&(clearInterval(v),v=!1),h.each(function(n){var i,r,a=t(this);a.attr("class",function(t,e){return e&&e.replace(u,"").replace(f," ")}),i=a.outerWidth(),0!==p.spacing&&a.css("margin-right",i*p.spacing+"px"),r=a.position().left,b[n]=-1*(r+i/2-l/2),n===h.length-1&&(L(),e&&setTimeout(I,1))})):v=v||setInterval(function(){P(e)},500)}function L(){var e,n,r,a=h.length;h.each(function(i){e=t(this),n=" ",i===x?(n+=c.itemCurrent,r=a+1):i<x?(n+=c.itemPast+" "+c.itemPast+"-"+(x-i),r=a-(x-i)):(n+=c.itemFuture+" "+c.itemFuture+"-"+(i-x),r=a-(i-x)),e.css("z-index",r).attr("class",function(t,e){return e&&e.replace(u,"").replace(f," ")+n})}),x>=0&&(l&&void 0!==b[x]||P(!0),s?i.css("transform","translateX("+b[x]+"px)"):i.css({left:b[x]+"px"})),function(){if(p.nav){var e=d.data("flip-category");g.removeClass(c.navCurrent),_.filter(function(){return t(this).data("index")===x||e&&t(this).data("category")===e}).parent().addClass(c.navCurrent)}}()}function D(t){var e=x;if(!(h.length<=1))return"prev"===t?x>0?x--:p.loop&&(x=h.length-1):"next"===t?x<h.length-1?x++:p.loop&&(x=0):"number"==typeof t?x=t:void 0!==t&&(x=h.index(t),p.loop&&e!=x&&(e==h.length-1&&x!=h.length-2&&(x=0),0==e&&1!=x&&(x=h.length-1))),d=h.eq(x),x!==e&&p.onItemSwitch&&p.onItemSwitch.call(y,h[x],h[e]),L(),y}function E(t){return p.autoplay=t||p.autoplay,clearInterval(w),w=setInterval(function(){var t=x;D("next"),t!==x||p.loop||clearInterval(w)},p.autoplay),y}function M(){return clearInterval(w),w=0,y}function T(t){return M(),p.autoplay&&t&&(w=-1),y}function X(){P(!0),y.hide().css("visibility","").addClass(c.active).fadeIn(p.fadeIn)}function j(){var e;if(i=y.find(p.itemContainer).addClass(c.container),!((h=i.find(p.itemSelector)).length<=1))return h.addClass(c.item).each(function(){var e=t(this);e.children("."+c.itemContent).length||e.wrapInner('<div class="'+c.itemContent+'" />')}),p.click&&h.on("click.flipster touchend.flipster",function(e){C||(t(this).hasClass(c.itemCurrent)||e.preventDefault(),D(this))}),p.buttons&&h.length>1&&(y.find("."+c.button).remove(),y.append(k("prev"),k("next"))),e={},!p.nav||h.length<=1||(m&&m.remove(),m=t('<ul class="'+c.nav+'" role="navigation" />'),_=t(""),h.each(function(n){var i=t(this),r=i.data("flip-category"),a=i.data("flip-title")||i.attr("title")||n,o=t('<a href="#" class="'+c.navLink+'">'+a+"</a>").data("index",n);if(_=_.add(o),r){if(!e[r]){var s=t('<li class="'+c.navItem+" "+c.navCategory+'">'),l=t('<a href="#" class="'+c.navLink+" "+c.navCategoryLink+'" data-flip-category="'+r+'">'+r+"</a>").data("category",r).data("index",n);e[r]=t('<ul class="'+c.navChild+'" />'),_=_.add(l),s.append(l,e[r]).appendTo(m)}e[r].append(o)}else m.append(o);o.wrap('<li class="'+c.navItem+'">')}),m.on("click","a",function(e){var n=t(this).data("index");n>=0&&(D(n),e.preventDefault())}),"after"===p.nav?y.append(m):y.prepend(m),g=m.find("."+c.navItem)),x>=0&&D(x),y}n={jump:D,next:function(){return D("next")},prev:function(){return D("prev")},play:E,stop:M,pause:T,index:j},y.data("methods",n),y.hasClass(c.active)||function(){var t;if(y.css("visibility","hidden"),j(),h.length<=1)y.css("visibility","");else{t=!!p.style&&"flipster--"+p.style.split(" ").join(" flipster--"),y.addClass([c.main,s?"flipster--transform":" flipster--no-transform",t,p.click?"flipster--click":""].join(" ")),p.start&&(x="center"===p.start?Math.floor(h.length/2):p.start),D(x);var n,r=y.find("img");if(r.length){var a=0;r.on("load",function(){++a>=r.length&&X()}),setTimeout(X,750)}else X();o.on("resize.flipster",e(P,400)),p.autoplay&&E(),p.pauseOnHover&&i.on("mouseenter.flipster",function(){w?T(!0):M()}).on("mouseleave.flipster",function(){-1===w&&E()}),n=y,p.keyboard&&(n[0].tabIndex=0,n.on("keydown.flipster",e(function(t){var e=t.which;37!==e&&39!==e||(D(37===e?"prev":"next"),t.preventDefault())},250))),function(t){if(p.scrollwheel){var n,i,r=!1,a=0,s=0,l=0,c=/mozilla/.test(navigator.userAgent.toLowerCase())&&!/webkit/.test(navigator.userAgent.toLowerCase());t.on("mousewheel.flipster wheel.flipster",function(){r=!0}).on("mousewheel.flipster wheel.flipster",e(function(t){clearTimeout(s),s=setTimeout(function(){a=0,l=0},300),t=t.originalEvent,l+=t.wheelDelta||-1*(t.deltaY+t.deltaX),Math.abs(l)<25&&!c||(a++,i!==(n=l>0?"prev":"next")&&(a=0),i=n,(a<6||a%3==0)&&D(n),l=0)},50)),o.on("mousewheel.flipster wheel.flipster",function(t){r&&(t.preventDefault(),r=!1)})}}(i),function(t){var e,n,i,r,a,o;p.touch&&t.on({"touchstart.flipster":function(t){t=t.originalEvent,e=t.touches?t.touches[0].clientX:t.clientX,n=t.touches?t.touches[0].clientY:t.clientY},"touchmove.flipster":function(t){t=t.originalEvent,i=t.touches?t.touches[0].clientX:t.clientX,r=t.touches?t.touches[0].clientY:t.clientY,o=i-e,a=r-n,Math.abs(o)>30&&Math.abs(a)<100&&t.preventDefault()},"touchend.flipster touchcancel.flipster ":function(){o=i-e,a=r-n,Math.abs(o)>30&&Math.abs(a)<100&&D(o>0?"prev":"next")}})}(i)}}()})},t});
//# sourceMappingURL=sourcemaps/flipster.js.map
